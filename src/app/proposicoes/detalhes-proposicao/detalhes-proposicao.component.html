<app-loading *ngIf="isLoading | async"></app-loading>
<div class="detalhes-proposicoes-conteiner app-container">
  <div class="top-info-container"[hidden]="isLoading | async">
    <div class="container">
      <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
          <li class="breadcrumb-item">
            <a [routerLink]="['/']"> Proposições </a>
          </li>

          <li class="breadcrumb-item">
            <a [routerLink]="'/proposicoes'" [queryParams]="{'interesse': interesseModel?.interesse}">
              {{ interesseModel?.nome_interesse }}
            </a>
          </li>

          <li class="breadcrumb-item">
            <span>
              {{ proposicao?.etapas[proposicao?.etapas.length - 1]?.sigla }}
            </span>
          </li>
        </ol>
      </nav>
      <div  class="mt-4 row">
        <div class="col">
          <h4>
            {{ proposicao?.etapas[proposicao?.etapas.length - 1]?.sigla }}
          </h4>

          <div>
            <h5
              *ngIf="
                proposicao?.interesse[0]?.apelido &&
                proposicao?.interesse[0]?.apelido !== 'nan'
              "
              class="mb-4"
            >
              {{ proposicao?.interesse[0]?.apelido }}
            </h5>
            <app-situacao-proposicao
              [proposicao]="proposicao"
            ></app-situacao-proposicao>
            <span
              class="tag badge badge-gray"
              *ngIf="
                proposicao?.interesse[0]?.advocacy_link &&
                proposicao?.interesse[0]?.advocacy_link !== 'nan'
              "
              [ngbPopover]="popAdvocacy"
              triggers="mouseenter:mouseleave"
            >
              advocacy box
            </span>
            <ng-template #popAdvocacy>
              Existem notas técnicas de OSCs disponíveis para esta proposição.
              <div class="text-right">
                <a
                  href="{{ proposicao?.interesse[0]?.advocacy_link }}"
                  target="_blank"
                  class="btn btn-link btn-sm"
                >
                  Ver notas
                </a>
              </div>
            </ng-template>
          </div>
        </div>
        <div class="col-5"></div>
      </div>
      <div [hidden]="!showDetails" class="row">
        <div class="col-8">
          <div class="row">
            <div class="col-6">
              <app-lista-autores
                [autores]="proposicao?.autoresProposicao"
              ></app-lista-autores>
            </div>
            <div class="col-6">
              <app-lista-relatores
                [etapas]="proposicao?.etapas"
                [interesse]="proposicao?.interesse[0]?.interesse"
              ></app-lista-relatores>
            </div>
          </div>
        </div>
        <div class="col-4">
          <app-lista-locais-atuais
            *ngIf="
              proposicao?.etapas[proposicao?.etapas.length - 1]?.status ===
              'Ativa'
            "
            [locais]="proposicao?.etapas[proposicao?.etapas.length - 1]?.resumo_tramitacao"
          >
          </app-lista-locais-atuais>

          <div class="ultimas-atualizacoes-block">
            <div
              class
              *ngIf="
                proposicao?.destaques.length ||
                proposicao?.interesse[0]?.advocacy_link !== 'nan'
              "
            >
              <app-destaques-proposicao
                [destaques]="destaques"
                *ngFor="let destaques of proposicao?.destaques"
              ></app-destaques-proposicao>
              <div
                class="chip"
                *ngIf="
                  proposicao?.interesse[0]?.advocacy_link &&
                  proposicao?.interesse[0]?.advocacy_link !== 'nan'
                "
                [ngbPopover]="popAdvocacy"
                triggers="mouseenter:mouseleave"
              >
                <div class="chip-icon">
                  <span class="material-icons">label_important</span>
                </div>
                <div class="chip-text">
                  <span>advocacy box</span>
                </div>
              </div>
              <ng-template #popAdvocacy>
                Existem notas técnicas de OSCs disponíveis para esta proposição.
                <div class="text-right">
                  <a
                    href="{{ proposicao?.interesse[0]?.advocacy_link }}"
                    target="_blank"
                    class="btn btn-link btn-sm"
                  >
                    Ver notas
                  </a>
                </div>
              </ng-template>
            </div>
            <div *ngIf="!proposicao?.destaques.length">
              <div
                *ngIf="
                  !['Ordinária', 'Indefinido'].includes(
                    proposicao?.etapas[proposicao?.etapas.length - 1]
                      ?.regime_tramitacao
                  )
                "
                class="chip"
                ngbPopover="Regime de tramitação"
                triggers="mouseenter:mouseleave"
              >
                <div class="chip-icon">
                  <span class="material-icons">label_important</span>
                </div>
                <div class="chip-text">
                  <span>{{
                    proposicao?.etapas[proposicao?.etapas.length - 1]
                      ?.regime_tramitacao
                  }}</span>
                </div>
              </div>
              <div
                *ngIf="
                  proposicao?.etapas[proposicao?.etapas.length - 1]?.status !==
                  'Ativa'
                "
                class="chip"
                ngbPopover="A proposição foi finalizada"
                triggers="mouseenter:mouseleave"
              >
                <div class="chip-icon">
                  <span class="material-icons">label_important</span>
                </div>
                <div class="chip-text">
                  <span>{{
                    proposicao?.etapas[proposicao?.etapas.length - 1]?.status
                  }}</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div [hidden]="!showDetails" class="row">
        <div class="col-12">
          <app-ementas [proposicao]="proposicao"></app-ementas>
        </div>
      </div>
      <div [hidden]="!showDetails" class="row">
        <div class="col-12">
          <app-assuntos-relacionados
            [proposicao]="proposicao"
          ></app-assuntos-relacionados>
        </div>
      </div>
    </div>
    <div class="container">
      <div class="row justify-content-md-center mt-3">
        <button
          (click)="toogleShowDetails()"
          [hidden]="!showDetails"
          class="button-show button-show-less"
        >
          <span
            ><img src="../../../assets/imgs/chevron-solid.svg" alt="chevron"
          /></span>
        </button>
      </div>
    </div>
  </div>
  <div class="container">
    <div class="row justify-content-md-center">
      <button
        (click)="toogleShowDetails()"
        [hidden]="showDetails"
        class="button-show button-show-more"
      >
        <span
          ><img src="../../../assets/imgs/chevron-solid.svg" alt="chevron"
        /></span>
      </button>
    </div>
  </div>
  <div class="modals-container">
    <div class="container">
      <div class="modal-content mt-5 mb-5">
        <app-progresso></app-progresso>
      </div>
      <div class="modal-content mt-5 mb-5">
        <app-temperatura-pressao></app-temperatura-pressao>
      </div>
      <div class="modal-content mt-5 mb-5">
        <app-atuacao-parlamentar></app-atuacao-parlamentar>
      </div>
      <div class="modal-content mt-5 mb-5">
        <app-rede-influencia></app-rede-influencia>
      </div>
    </div>
  </div>
</div>
<app-footer [interesseModel]="interesseModel"></app-footer>
